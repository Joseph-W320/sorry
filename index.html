<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>系统修复请求: 乖乖专用</title>
    <style>
        /* 基础样式 */
        body { background-color: #1a1a1a; margin: 0; padding: 20px; display: flex; align-items: center; justify-content: center; min-height: 100vh; overflow: hidden; font-family: 'Microsoft YaHei', 'Courier New', monospace; }
        
        /* 启动遮罩：解决微信/浏览器音频不自动播放问题 */
        #start-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #00ff00; cursor: pointer; }
        
        #display-window { width: 100%; max-width: 700px; text-align: left; }

        /* 字体增强与变色动画 */
        .scene p { 
            font-size: 22px; /* 增加字号 */
            font-weight: bold; /* 加粗 */
            margin: 15px 0;
            animation: colorChange 4s forwards; /* 变色动画 */
        }

        @keyframes colorChange {
            0% { color: #00ff00; opacity: 0; }   /* 初始绿色 */
            20% { opacity: 1; }
            100% { color: #ff69b4; }             /* 最终粉色 */
        }

        .scene { display: none; }
        .active { display: block; }

        /* 爱心飘落 */
        .heart-particle { position: fixed; top: -20px; color: #ff69b4; font-size: 24px; user-select: none; z-index: 1000; pointer-events: none; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }

        /* 猫咪与最终文字 */
        .cat-box { text-align: center; }
        .cat-img { width: 250px; border-radius: 25px; box-shadow: 0 0 20px #ff69b4; margin-bottom: 25px; }
        .final-text { color: #ff69b4; font-size: 26px; font-weight: bold; line-height: 1.8; animation: beat 1.5s infinite; }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    </style>
</head>
<body>

    <div id="start-overlay" onclick="initSystem()">
        <div style="font-size: 40px; margin-bottom: 20px;">❤</div>
        <p>点击开启[乖乖]专属修复协议</p>
    </div>

    <div id="display-window">
        <div id="scene1" class="scene"></div>
        <div id="scene2" class="scene"></div>
        <div id="scene3" class="scene"></div>
        <div id="scene4" class="scene cat-box">
            <img class="cat-img" src="cat.gif" alt="道歉猫咪">
            <div class="final-text" id="final-msg"></div>
        </div>
    </div>

    <audio id="meow-sound" src="meow.mp3" loop preload="auto"></audio>

    <script>
        const scene1 = document.getElementById('scene1');
        const scene2 = document.getElementById('scene2');
        const scene3 = document.getElementById('scene3');
        const scene4 = document.getElementById('scene4');
        const audio = document.getElementById('meow-sound');
        const overlay = document.getElementById('start-overlay');

        function initSystem() {
            overlay.style.display = 'none'; // 隐藏遮罩
            startDrama();
        }

        // 打字与变色效果，增加间隔到 1.5秒
        function typeEffect(element, textArray, callback) {
            let i = 0;
            function addLine() {
                if (i < textArray.length) {
                    const p = document.createElement('p');
                    p.textContent = textArray[i];
                    element.appendChild(p);
                    i++;
                    setTimeout(addLine, 1500); // 间隔增长
                } else {
                    setTimeout(callback, 2000);
                }
            }
            addLine();
        }

        function startProgress(element, callback) {
            let progress = 0;
            const p = document.createElement('p');
            element.appendChild(p);
            const interval = setInterval(() => {
                progress++;
                p.textContent = `系统修复中... ${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                    const p2 = document.createElement('p');
                    p2.textContent = "Bug 已修复，系统请求重启。";
                    element.appendChild(p2);
                    setTimeout(callback, 2000);
                }
            }, 60); 
        }

        function createHearts() {
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'heart-particle';
                heart.innerHTML = '❤';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDuration = (Math.random() * 3 + 2) + 's';
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 5000);
            }, 250);
        }

        function startDrama() {
            // 第一画面
            scene1.classList.add('active');
            typeEffect(scene1, [
                "正在建立与 [乖乖] 的通信连接... 成功",
                "正在自检情绪控制系统... 发现严重错误 (Error 404)",
                "正在加载“求原谅”协议 v1.0..."
            ], () => {
                scene1.classList.remove('active');
                // 第二画面
                scene2.classList.add('active');
                typeEffect(scene2, [
                    "> git commit -m '修复：忽略了乖乖的想法和感受'",
                    "> git commit -m '更新：将小兮大人的心情优先级设为最高 (Highest)'",
                    "> git commit -m '重构：优化沟通模式，增加 1000% 的体贴'",
                    "> git push -f origin 永远在一起"
                ], () => {
                    scene2.classList.remove('active');
                    // 第三画面
                    scene3.classList.add('active');
                    startProgress(scene3, () => {
                        scene3.classList.remove('active');
                        // 第四、五画面（音乐开启）
                        audio.play(); // 此处触发音乐循环
                        scene4.classList.add('active');
                        createHearts();
                        document.getElementById('final-msg').innerHTML = "小兮大人，你愿意给这个笨蛋<br>一个重新运行的机会吗？喵~";
                    });
                });
            });
        }
    </script>
</body>
</html>
